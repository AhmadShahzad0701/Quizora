<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FR Progress Visualization – Quizora FYP</title>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 10px;
    }

    p {
      text-align: center;
      color: #555;
      margin-bottom: 30px;
    }

    .charts {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(420px, 1fr));
      gap: 25px;
    }

    .chart-box {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

  <h1>Functional Requirements Progress</h1>
  <p>Quizora – Final Year Project (FYP)</p>

  <div class="charts">
    <div class="chart-box">
      <canvas id="pieChart"></canvas>
    </div>

    <div class="chart-box">
      <canvas id="statusBarChart"></canvas>
    </div>

    <div class="chart-box">
      <canvas id="moduleBarChart"></canvas>
    </div>
  </div>

<script>
/* =====================================================
   LOAD FR DATA FROM JSON
   ===================================================== */
fetch("fr-data.json")
  .then(response => response.json())
  .then(frData => {
    buildCharts(frData);
  })
  .catch(error => {
    console.error("Error loading FR data:", error);
  });

/* =====================================================
   MAIN FUNCTION
   ===================================================== */
function buildCharts(frData) {

  /* ---------- STATUS COUNTS ---------- */
  let done = 0;
  let partial = 0;
  let notDone = 0;

  frData.forEach(fr => {
    if (fr.status === "done") done++;
    else if (fr.status === "partial") partial++;
    else notDone++;
  });

  /* ---------- PIE CHART (OVERALL) ---------- */
  new Chart(document.getElementById("pieChart"), {
    type: "pie",
    data: {
      labels: ["Done", "Partially Done", "Not Done"],
      datasets: [{
        data: [done, partial, notDone],
        backgroundColor: ["#2ecc71", "#f1c40f", "#e74c3c"]
      }]
    },
    options: {
      plugins: {
        title: {
          display: true,
          text: "Overall FR Completion Status"
        },
        tooltip: {
          callbacks: {
            label: ctx => `${ctx.label}: ${ctx.raw}`
          }
        }
      }
    }
  });

  /* ---------- BAR CHART (STATUS COUNT) ---------- */
  new Chart(document.getElementById("statusBarChart"), {
    type: "bar",
    data: {
      labels: ["Done", "Partially Done", "Not Done"],
      datasets: [{
        label: "Number of FRs",
        data: [done, partial, notDone],
        backgroundColor: ["#2ecc71", "#f1c40f", "#e74c3c"]
      }]
    },
    options: {
      scales: {
        y: { beginAtZero: true }
      },
      plugins: {
        title: {
          display: true,
          text: "FR Status Distribution"
        }
      }
    }
  });

  /* ---------- MODULE-WISE BAR CHART ---------- */
  const moduleMap = {};

  frData.forEach(fr => {
    if (!moduleMap[fr.module]) {
      moduleMap[fr.module] = 0;
    }
    if (fr.status === "done") {
      moduleMap[fr.module]++;
    }
  });

  const modules = Object.keys(moduleMap);
  const moduleCounts = Object.values(moduleMap);

  new Chart(document.getElementById("moduleBarChart"), {
    type: "bar",
    data: {
      labels: modules,
      datasets: [{
        label: "Completed FRs",
        data: moduleCounts,
        backgroundColor: "#3498db"
      }]
    },
    options: {
      scales: {
        y: { beginAtZero: true }
      },
      plugins: {
        title: {
          display: true,
          text: "Module-wise Completed Functional Requirements"
        }
      }
    }
  });
}
</script>

</body>
</html>
